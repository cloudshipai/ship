{
  "SchemaVersion": 2,
  "CreatedAt": "2025-06-26T22:17:14.597652224Z",
  "ArtifactName": ".",
  "ArtifactType": "filesystem",
  "Metadata": {
    "ImageConfig": {
      "architecture": "",
      "created": "0001-01-01T00:00:00Z",
      "os": "",
      "rootfs": {
        "type": "",
        "diff_ids": null
      },
      "config": {}
    }
  },
  "Results": [
    {
      "Target": ".",
      "Class": "config",
      "Type": "terraformplan",
      "MisconfSummary": {
        "Successes": 38,
        "Failures": 0
      }
    },
    {
      "Target": ".terraform/modules/moose_fargate.db/modules/db_instance/main.tf",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 0,
        "Failures": 2
      },
      "Misconfigurations": [
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0133",
          "AVDID": "AVD-AWS-0133",
          "Title": "Enable Performance Insights to detect potential problems",
          "Description": "Enabling Performance insights allows for greater depth in monitoring data.\nFor example, information about active sessions could help diagose a compromise or assist in the investigation\n",
          "Message": "Instance does not have performance insights enabled.",
          "Namespace": "builtin.aws.rds.aws0133",
          "Query": "data.builtin.aws.rds.aws0133.deny",
          "Resolution": "Enable performance insights",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0133",
          "References": [
            "https://aws.amazon.com/rds/performance-insights/",
            "https://avd.aquasec.com/misconfig/avd-aws-0133"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "module.moose_fargate",
            "Provider": "AWS",
            "Service": "rds",
            "StartLine": 95,
            "EndLine": 95,
            "Code": {
              "Lines": [
                {
                  "Number": 30,
                  "Content": "resource \"aws_db_instance\" \"this\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_db_instance\"\u001b[0m \u001b[38;5;37m\"this\"\u001b[0m {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 31,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 95,
                  "Content": "  performance_insights_enabled          = var.performance_insights_enabled",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mperformance_insights_enabled\u001b[0m          = \u001b[38;5;33mvar\u001b[0m.performance_insights_enabled",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 151,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 152,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m}",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "aws_db_instance.this[0]",
                "Filename": ".terraform/modules/moose_fargate.db/modules/db_instance/main.tf",
                "Location": {
                  "StartLine": 30,
                  "EndLine": 152
                }
              },
              {
                "Resource": "module.db_instance",
                "Filename": "terraform-aws-modules/rds/aws/.terraform/modules/moose_fargate.db/main.tf",
                "Location": {
                  "StartLine": 61,
                  "EndLine": 165
                }
              },
              {
                "Resource": "module.db",
                "Filename": "fargate/db.tf",
                "Location": {
                  "StartLine": 1,
                  "EndLine": 50
                }
              },
              {
                "Resource": "module.moose_fargate",
                "Filename": "app.tf",
                "Location": {
                  "StartLine": 8,
                  "EndLine": 39
                }
              }
            ],
            "RenderedCause": {
              "Raw": "resource \"aws_db_instance\" \"this\" {\n  performance_insights_enabled = false\n}",
              "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_db_instance\"\u001b[0m \u001b[38;5;37m\"this\"\u001b[0m {\n  \u001b[38;5;245mperformance_insights_enabled\u001b[0m = \u001b[38;5;166mfalse\n\u001b[0m}"
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0176",
          "AVDID": "AVD-AWS-0176",
          "Title": "RDS IAM Database Authentication Disabled",
          "Description": "Ensure IAM Database Authentication is enabled for RDS database instances to manage database access",
          "Message": "Instance does not have IAM Authentication enabled",
          "Namespace": "builtin.aws.rds.aws0176",
          "Query": "data.builtin.aws.rds.aws0176.deny",
          "Resolution": "Modify the PostgreSQL and MySQL type RDS instances to enable IAM database authentication.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0176",
          "References": [
            "https://docs.aws.amazon.com/neptune/latest/userguide/iam-auth.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0176"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "module.moose_fargate",
            "Provider": "AWS",
            "Service": "rds",
            "StartLine": 56,
            "EndLine": 56,
            "Code": {
              "Lines": [
                {
                  "Number": 30,
                  "Content": "resource \"aws_db_instance\" \"this\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_db_instance\"\u001b[0m \u001b[38;5;37m\"this\"\u001b[0m {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 31,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 56,
                  "Content": "  iam_database_authentication_enabled = var.iam_database_authentication_enabled",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245miam_database_authentication_enabled\u001b[0m = \u001b[38;5;33mvar\u001b[0m.iam_database_authentication_enabled",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 151,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 152,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m}",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "aws_db_instance.this[0]",
                "Filename": ".terraform/modules/moose_fargate.db/modules/db_instance/main.tf",
                "Location": {
                  "StartLine": 30,
                  "EndLine": 152
                }
              },
              {
                "Resource": "module.db_instance",
                "Filename": "terraform-aws-modules/rds/aws/.terraform/modules/moose_fargate.db/main.tf",
                "Location": {
                  "StartLine": 61,
                  "EndLine": 165
                }
              },
              {
                "Resource": "module.db",
                "Filename": "fargate/db.tf",
                "Location": {
                  "StartLine": 1,
                  "EndLine": 50
                }
              },
              {
                "Resource": "module.moose_fargate",
                "Filename": "app.tf",
                "Location": {
                  "StartLine": 8,
                  "EndLine": 39
                }
              }
            ],
            "RenderedCause": {
              "Raw": "resource \"aws_db_instance\" \"this\" {\n  iam_database_authentication_enabled = false\n}",
              "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_db_instance\"\u001b[0m \u001b[38;5;37m\"this\"\u001b[0m {\n  \u001b[38;5;245miam_database_authentication_enabled\u001b[0m = \u001b[38;5;166mfalse\n\u001b[0m}"
            }
          }
        }
      ]
    },
    {
      "Target": "app_runner",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 38,
        "Failures": 0
      }
    },
    {
      "Target": "dev_dynamo",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 39,
        "Failures": 0
      }
    },
    {
      "Target": "dev_dynamo/main.tf",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 0,
        "Failures": 2
      },
      "Misconfigurations": [
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0024",
          "AVDID": "AVD-AWS-0024",
          "Title": "Point in time recovery should be enabled to protect DynamoDB table",
          "Description": "DynamoDB tables should be protected against accidentally or malicious write/delete actions by ensuring that there is adequate protection.\nBy enabling point-in-time-recovery you can restore to a known point in the event of loss of data.\n",
          "Message": "Point-in-time recovery is not enabled.",
          "Namespace": "builtin.aws.dynamodb.aws0024",
          "Query": "data.builtin.aws.dynamodb.aws0024.deny",
          "Resolution": "Enable point in time recovery",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0024",
          "References": [
            "https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/PointInTimeRecovery.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0024"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_dynamodb_table.moose-env",
            "Provider": "AWS",
            "Service": "dynamodb",
            "StartLine": 23,
            "EndLine": 87,
            "Code": {
              "Lines": [
                {
                  "Number": 23,
                  "Content": "resource \"aws_dynamodb_table\" \"moose-env\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_dynamodb_table\"\u001b[0m \u001b[38;5;37m\"moose-env\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "  name             = \"${var.env}-mooseDataProd\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mname\u001b[0m             = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.env\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-mooseDataProd\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "  billing_mode     = \"PROVISIONED\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mbilling_mode\u001b[0m     = \u001b[38;5;37m\"PROVISIONED\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "  read_capacity  = 1",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mread_capacity\u001b[0m  = \u001b[38;5;37m1",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 27,
                  "Content": "  write_capacity = 1",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mwrite_capacity\u001b[0m = \u001b[38;5;37m1",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 28,
                  "Content": "  hash_key       = \"pk\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mhash_key\u001b[0m       = \u001b[38;5;37m\"pk\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 29,
                  "Content": "  range_key      = \"sk\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mrange_key\u001b[0m      = \u001b[38;5;37m\"sk\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 30,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 31,
                  "Content": "  attribute {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  attribute {",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 32,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0025",
          "AVDID": "AVD-AWS-0025",
          "Title": "DynamoDB tables should use at rest encryption with a Customer Managed Key",
          "Description": "Using AWS managed keys does not allow for fine grained control. DynamoDB tables are encrypted by default using AWS managed encryption keys. To increase control of the encryption and control the management of factors like key rotation, use a Customer Managed Key.\n",
          "Message": "Table encryption does not use a customer-managed KMS key.",
          "Namespace": "builtin.aws.dynamodb.aws0025",
          "Query": "data.builtin.aws.dynamodb.aws0025.deny",
          "Resolution": "Enable server side encryption with a customer managed key",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0025",
          "References": [
            "https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/EncryptionAtRest.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0025"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_dynamodb_table.moose-env",
            "Provider": "AWS",
            "Service": "dynamodb",
            "StartLine": 23,
            "EndLine": 87,
            "Code": {
              "Lines": [
                {
                  "Number": 23,
                  "Content": "resource \"aws_dynamodb_table\" \"moose-env\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_dynamodb_table\"\u001b[0m \u001b[38;5;37m\"moose-env\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "  name             = \"${var.env}-mooseDataProd\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mname\u001b[0m             = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.env\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-mooseDataProd\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "  billing_mode     = \"PROVISIONED\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mbilling_mode\u001b[0m     = \u001b[38;5;37m\"PROVISIONED\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "  read_capacity  = 1",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mread_capacity\u001b[0m  = \u001b[38;5;37m1",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 27,
                  "Content": "  write_capacity = 1",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mwrite_capacity\u001b[0m = \u001b[38;5;37m1",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 28,
                  "Content": "  hash_key       = \"pk\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mhash_key\u001b[0m       = \u001b[38;5;37m\"pk\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 29,
                  "Content": "  range_key      = \"sk\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mrange_key\u001b[0m      = \u001b[38;5;37m\"sk\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 30,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 31,
                  "Content": "  attribute {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  attribute {",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 32,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        }
      ]
    },
    {
      "Target": "dynamodb.tf",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 0,
        "Failures": 2
      },
      "Misconfigurations": [
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0024",
          "AVDID": "AVD-AWS-0024",
          "Title": "Point in time recovery should be enabled to protect DynamoDB table",
          "Description": "DynamoDB tables should be protected against accidentally or malicious write/delete actions by ensuring that there is adequate protection.\nBy enabling point-in-time-recovery you can restore to a known point in the event of loss of data.\n",
          "Message": "Point-in-time recovery is not enabled.",
          "Namespace": "builtin.aws.dynamodb.aws0024",
          "Query": "data.builtin.aws.dynamodb.aws0024.deny",
          "Resolution": "Enable point in time recovery",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0024",
          "References": [
            "https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/PointInTimeRecovery.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0024"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_dynamodb_table.moose",
            "Provider": "AWS",
            "Service": "dynamodb",
            "StartLine": 1,
            "EndLine": 64,
            "Code": {
              "Lines": [
                {
                  "Number": 1,
                  "Content": "resource \"aws_dynamodb_table\" \"moose\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_dynamodb_table\"\u001b[0m \u001b[38;5;37m\"moose\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 2,
                  "Content": "  name             = \"mooseData${var.env}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mname\u001b[0m             = \u001b[38;5;37m\"mooseData\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.env\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 3,
                  "Content": "  billing_mode     = \"PROVISIONED\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mbilling_mode\u001b[0m     = \u001b[38;5;37m\"PROVISIONED\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 4,
                  "Content": "  read_capacity  = 5",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mread_capacity\u001b[0m  = \u001b[38;5;37m5",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 5,
                  "Content": "  write_capacity = 5",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mwrite_capacity\u001b[0m = \u001b[38;5;37m5",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 6,
                  "Content": "  hash_key       = \"pk\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mhash_key\u001b[0m       = \u001b[38;5;37m\"pk\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 7,
                  "Content": "  range_key      = \"sk\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mrange_key\u001b[0m      = \u001b[38;5;37m\"sk\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 8,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 9,
                  "Content": "  attribute {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  attribute {",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 10,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0025",
          "AVDID": "AVD-AWS-0025",
          "Title": "DynamoDB tables should use at rest encryption with a Customer Managed Key",
          "Description": "Using AWS managed keys does not allow for fine grained control. DynamoDB tables are encrypted by default using AWS managed encryption keys. To increase control of the encryption and control the management of factors like key rotation, use a Customer Managed Key.\n",
          "Message": "Table encryption does not use a customer-managed KMS key.",
          "Namespace": "builtin.aws.dynamodb.aws0025",
          "Query": "data.builtin.aws.dynamodb.aws0025.deny",
          "Resolution": "Enable server side encryption with a customer managed key",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0025",
          "References": [
            "https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/EncryptionAtRest.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0025"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_dynamodb_table.moose",
            "Provider": "AWS",
            "Service": "dynamodb",
            "StartLine": 1,
            "EndLine": 64,
            "Code": {
              "Lines": [
                {
                  "Number": 1,
                  "Content": "resource \"aws_dynamodb_table\" \"moose\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_dynamodb_table\"\u001b[0m \u001b[38;5;37m\"moose\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 2,
                  "Content": "  name             = \"mooseData${var.env}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mname\u001b[0m             = \u001b[38;5;37m\"mooseData\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.env\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 3,
                  "Content": "  billing_mode     = \"PROVISIONED\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mbilling_mode\u001b[0m     = \u001b[38;5;37m\"PROVISIONED\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 4,
                  "Content": "  read_capacity  = 5",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mread_capacity\u001b[0m  = \u001b[38;5;37m5",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 5,
                  "Content": "  write_capacity = 5",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mwrite_capacity\u001b[0m = \u001b[38;5;37m5",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 6,
                  "Content": "  hash_key       = \"pk\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mhash_key\u001b[0m       = \u001b[38;5;37m\"pk\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 7,
                  "Content": "  range_key      = \"sk\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mrange_key\u001b[0m      = \u001b[38;5;37m\"sk\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 8,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 9,
                  "Content": "  attribute {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  attribute {",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 10,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        }
      ]
    },
    {
      "Target": "fargate/fargate.tf",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 0,
        "Failures": 2
      },
      "Misconfigurations": [
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0017",
          "AVDID": "AVD-AWS-0017",
          "Title": "CloudWatch log groups should be encrypted using CMK",
          "Description": "CloudWatch log groups are encrypted by default, however, to get the full benefit of controlling key rotation and other KMS aspects a KMS CMK should be used.\n",
          "Message": "Log group is not encrypted.",
          "Namespace": "builtin.aws.cloudwatch.aws0017",
          "Query": "data.builtin.aws.cloudwatch.aws0017.deny",
          "Resolution": "Enable CMK encryption of CloudWatch Log Groups",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0017",
          "References": [
            "https://docs.aws.amazon.com/AmazonCloudWatch/latest/logs/encrypt-log-data-kms.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0017"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "module.moose_fargate",
            "Provider": "AWS",
            "Service": "cloudwatch",
            "StartLine": 10,
            "EndLine": 12,
            "Code": {
              "Lines": [
                {
                  "Number": 10,
                  "Content": "resource \"aws_cloudwatch_log_group\" \"moose_data\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_cloudwatch_log_group\"\u001b[0m \u001b[38;5;37m\"moose_data\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 11,
                  "Content": "  name = \"${var.env}-moose-data-log-group\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mname\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.env\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-moose-data-log-group\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 12,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "module.moose_fargate",
                "Filename": "app.tf",
                "Location": {
                  "StartLine": 8,
                  "EndLine": 39
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0034",
          "AVDID": "AVD-AWS-0034",
          "Title": "ECS clusters should have container insights enabled",
          "Description": "Cloudwatch Container Insights provide more metrics and logs for container based applications and micro services.\n",
          "Message": "Cluster does not have container insights enabled.",
          "Namespace": "builtin.aws.ecs.aws0034",
          "Query": "data.builtin.aws.ecs.aws0034.deny",
          "Resolution": "Enable Container Insights",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0034",
          "References": [
            "https://docs.aws.amazon.com/AmazonCloudWatch/latest/monitoring/ContainerInsights.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0034"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "module.moose_fargate",
            "Provider": "AWS",
            "Service": "ecs",
            "StartLine": 16,
            "EndLine": 29,
            "Code": {
              "Lines": [
                {
                  "Number": 16,
                  "Content": "resource \"aws_ecs_cluster\" \"moose-data-cluster\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_ecs_cluster\"\u001b[0m \u001b[38;5;37m\"moose-data-cluster\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "  name = \"${var.env}-moose-data-cluster\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mname\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.env\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-moose-data-cluster\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "  tags = var.tags",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mtags\u001b[0m = \u001b[38;5;33mvar\u001b[0m.tags",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "  configuration {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  configuration {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "    execute_command_configuration {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    execute_command_configuration {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "      logging    = \"OVERRIDE\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;245mlogging\u001b[0m    = \u001b[38;5;37m\"OVERRIDE\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "      log_configuration {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      log_configuration {",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 25,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "module.moose_fargate",
                "Filename": "app.tf",
                "Location": {
                  "StartLine": 8,
                  "EndLine": 39
                }
              }
            ],
            "RenderedCause": {}
          }
        }
      ]
    },
    {
      "Target": "fargate/lb.tf",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 0,
        "Failures": 2
      },
      "Misconfigurations": [
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0052",
          "AVDID": "AVD-AWS-0052",
          "Title": "Load balancers should drop invalid headers",
          "Description": "Passing unknown or invalid headers through to the target poses a potential risk of compromise.\nBy setting drop_invalid_header_fields to true, anything that does not conform to well known, defined headers will be removed by the load balancer.\n",
          "Message": "Application load balancer is not set to drop invalid headers.",
          "Namespace": "builtin.aws.elb.aws0052",
          "Query": "data.builtin.aws.elb.aws0052.deny",
          "Resolution": "Set drop_invalid_header_fields to true",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0052",
          "References": [
            "https://docs.aws.amazon.com/elasticloadbalancing/latest/application/application-load-balancers.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0052"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "module.moose_fargate",
            "Provider": "AWS",
            "Service": "elb",
            "StartLine": 1,
            "EndLine": 12,
            "Code": {
              "Lines": [
                {
                  "Number": 1,
                  "Content": "resource \"aws_lb\" \"moose-lb\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_lb\"\u001b[0m \u001b[38;5;37m\"moose-lb\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 2,
                  "Content": "  name               = \"${var.env}-moose-data-lb\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mname\u001b[0m               = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.env\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-moose-data-lb\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 3,
                  "Content": "  internal           = false",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245minternal\u001b[0m           = \u001b[38;5;166mfalse",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 4,
                  "Content": "  load_balancer_type = \"application\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mload_balancer_type\u001b[0m = \u001b[38;5;37m\"application\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 5,
                  "Content": "  security_groups    = [aws_security_group.elb_app_sg.id]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245msecurity_groups\u001b[0m    = [aws_security_group.elb_app_sg.id]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 6,
                  "Content": "  subnets            = module.vpc.public_subnets ",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245msubnets\u001b[0m            = \u001b[38;5;33mmodule\u001b[0m.vpc.public_subnets ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 7,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 8,
                  "Content": "  enable_deletion_protection = false",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245menable_deletion_protection\u001b[0m = \u001b[38;5;166mfalse",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 9,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 10,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "module.moose_fargate",
                "Filename": "app.tf",
                "Location": {
                  "StartLine": 8,
                  "EndLine": 39
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0053",
          "AVDID": "AVD-AWS-0053",
          "Title": "Load balancer is exposed to the internet.",
          "Description": "There are many scenarios in which you would want to expose a load balancer to the wider internet, but this check exists as a warning to prevent accidental exposure of internal assets. You should ensure that this resource should be exposed publicly.\n",
          "Message": "Load balancer is exposed publicly.",
          "Namespace": "builtin.aws.elb.aws0053",
          "Query": "data.builtin.aws.elb.aws0053.deny",
          "Resolution": "Switch to an internal load balancer or add a tfsec ignore",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0053",
          "References": [
            "https://avd.aquasec.com/misconfig/avd-aws-0053"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "module.moose_fargate",
            "Provider": "AWS",
            "Service": "elb",
            "StartLine": 3,
            "EndLine": 3,
            "Code": {
              "Lines": [
                {
                  "Number": 1,
                  "Content": "resource \"aws_lb\" \"moose-lb\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_lb\"\u001b[0m \u001b[38;5;37m\"moose-lb\"\u001b[0m {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 2,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 3,
                  "Content": "  internal           = false",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245minternal\u001b[0m           = \u001b[38;5;166mfalse",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 11,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 12,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "aws_lb.moose-lb",
                "Filename": "fargate/lb.tf",
                "Location": {
                  "StartLine": 1,
                  "EndLine": 12
                }
              },
              {
                "Resource": "module.moose_fargate",
                "Filename": "app.tf",
                "Location": {
                  "StartLine": 8,
                  "EndLine": 39
                }
              }
            ],
            "RenderedCause": {}
          }
        }
      ]
    },
    {
      "Target": "fargate/sg.tf",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 0,
        "Failures": 3
      },
      "Misconfigurations": [
        {
          "Type": "Terraform Security Check",
          "ID": "aws-vpc-no-public-egress-sgr",
          "AVDID": "AVD-AWS-0104",
          "Title": "A security group rule should not allow unrestricted egress to any IP address.",
          "Description": "Opening up ports to connect out to the public internet is generally to be avoided. You should restrict access to IP addresses or ranges that are explicitly required where possible.\n",
          "Message": "Security group rule allows unrestricted egress to any IP address.",
          "Namespace": "builtin.aws.ec2.aws0104",
          "Query": "data.builtin.aws.ec2.aws0104.deny",
          "Resolution": "Set a more restrictive cidr range",
          "Severity": "CRITICAL",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/aws-vpc-no-public-egress-sgr",
          "References": [
            "https://docs.aws.amazon.com/whitepapers/latest/building-scalable-secure-multi-vpc-network-infrastructure/centralized-egress-to-internet.html",
            "https://avd.aquasec.com/misconfig/aws-vpc-no-public-egress-sgr"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "module.moose_fargate",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 18,
            "EndLine": 18,
            "Code": {
              "Lines": [
                {
                  "Number": 1,
                  "Content": "resource \"aws_security_group\" \"allow_tls\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_security_group\"\u001b[0m \u001b[38;5;37m\"allow_tls\"\u001b[0m {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 2,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "    cidr_blocks      = [\"0.0.0.0/0\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mcidr_blocks\u001b[0m      = [\u001b[38;5;37m\"0.0.0.0/0\"\u001b[0m]",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 24,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "egress",
                "Filename": "fargate/sg.tf",
                "Location": {
                  "StartLine": 14,
                  "EndLine": 20
                }
              },
              {
                "Resource": "aws_security_group.allow_tls",
                "Filename": "fargate/sg.tf",
                "Location": {
                  "StartLine": 1,
                  "EndLine": 25
                }
              },
              {
                "Resource": "module.moose_fargate",
                "Filename": "app.tf",
                "Location": {
                  "StartLine": 8,
                  "EndLine": 39
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "aws-vpc-no-public-egress-sgr",
          "AVDID": "AVD-AWS-0104",
          "Title": "A security group rule should not allow unrestricted egress to any IP address.",
          "Description": "Opening up ports to connect out to the public internet is generally to be avoided. You should restrict access to IP addresses or ranges that are explicitly required where possible.\n",
          "Message": "Security group rule allows unrestricted egress to any IP address.",
          "Namespace": "builtin.aws.ec2.aws0104",
          "Query": "data.builtin.aws.ec2.aws0104.deny",
          "Resolution": "Set a more restrictive cidr range",
          "Severity": "CRITICAL",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/aws-vpc-no-public-egress-sgr",
          "References": [
            "https://docs.aws.amazon.com/whitepapers/latest/building-scalable-secure-multi-vpc-network-infrastructure/centralized-egress-to-internet.html",
            "https://avd.aquasec.com/misconfig/aws-vpc-no-public-egress-sgr"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "module.moose_fargate",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 19,
            "EndLine": 19,
            "Code": {
              "Lines": [
                {
                  "Number": 1,
                  "Content": "resource \"aws_security_group\" \"allow_tls\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_security_group\"\u001b[0m \u001b[38;5;37m\"allow_tls\"\u001b[0m {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 2,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "    ipv6_cidr_blocks = [\"::/0\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mipv6_cidr_blocks\u001b[0m = [\u001b[38;5;37m\"::/0\"\u001b[0m]",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 24,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "egress",
                "Filename": "fargate/sg.tf",
                "Location": {
                  "StartLine": 14,
                  "EndLine": 20
                }
              },
              {
                "Resource": "aws_security_group.allow_tls",
                "Filename": "fargate/sg.tf",
                "Location": {
                  "StartLine": 1,
                  "EndLine": 25
                }
              },
              {
                "Resource": "module.moose_fargate",
                "Filename": "app.tf",
                "Location": {
                  "StartLine": 8,
                  "EndLine": 39
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "aws-vpc-add-description-to-security-group-rule",
          "AVDID": "AVD-AWS-0124",
          "Title": "Missing description for security group rule.",
          "Description": "Security group rules should include a description for auditing purposes.\n\nSimplifies auditing, debugging, and managing security groups.\n",
          "Message": "Security group rule does not have a description.",
          "Namespace": "builtin.aws.ec2.aws0124",
          "Query": "data.builtin.aws.ec2.aws0124.deny",
          "Resolution": "Add descriptions for all security groups rules",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/aws-vpc-add-description-to-security-group-rule",
          "References": [
            "https://www.cloudconformity.com/knowledge-base/aws/EC2/security-group-rules-description.html",
            "https://avd.aquasec.com/misconfig/aws-vpc-add-description-to-security-group-rule"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "module.moose_fargate",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 14,
            "EndLine": 20,
            "Code": {
              "Lines": [
                {
                  "Number": 1,
                  "Content": "resource \"aws_security_group\" \"allow_tls\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_security_group\"\u001b[0m \u001b[38;5;37m\"allow_tls\"\u001b[0m {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 2,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 14,
                  "Content": "  egress {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  egress {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 15,
                  "Content": "    from_port        = 0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mfrom_port\u001b[0m        = \u001b[38;5;37m0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "    to_port          = 0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mto_port\u001b[0m          = \u001b[38;5;37m0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "    protocol         = \"-1\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mprotocol\u001b[0m         = \u001b[38;5;37m\"-1\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "    cidr_blocks      = [\"0.0.0.0/0\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mcidr_blocks\u001b[0m      = [\u001b[38;5;37m\"0.0.0.0/0\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "    ipv6_cidr_blocks = [\"::/0\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mipv6_cidr_blocks\u001b[0m = [\u001b[38;5;37m\"::/0\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  }",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 24,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "aws_security_group.allow_tls",
                "Filename": "fargate/sg.tf",
                "Location": {
                  "StartLine": 1,
                  "EndLine": 25
                }
              },
              {
                "Resource": "module.moose_fargate",
                "Filename": "app.tf",
                "Location": {
                  "StartLine": 8,
                  "EndLine": 39
                }
              }
            ],
            "RenderedCause": {}
          }
        }
      ]
    },
    {
      "Target": "iam.tf",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 0,
        "Failures": 2
      },
      "Misconfigurations": [
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0345",
          "AVDID": "AVD-AWS-0345",
          "Title": "Disallow unrestricted S3 IAM Policies",
          "Description": "Ensure that the creation of the unrestricted S3 IAM policies is disallowed.",
          "Message": "IAM policy allows 's3:*' action",
          "Namespace": "builtin.aws.iam.aws0345",
          "Query": "data.builtin.aws.iam.aws0345.deny",
          "Resolution": "Create more restrictive S3 policies",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0345",
          "References": [
            "https://avd.aquasec.com/misconfig/avd-aws-0345"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_iam_policy.moose_instance_policy",
            "Provider": "AWS",
            "Service": "iam",
            "StartLine": 4,
            "EndLine": 61,
            "Code": {
              "Lines": [
                {
                  "Number": 2,
                  "Content": "resource \"aws_iam_policy\" \"moose_instance_policy\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_iam_policy\"\u001b[0m \u001b[38;5;37m\"moose_instance_policy\"\u001b[0m {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 3,
                  "Content": "    name = \"${var.env}-moose-instance-resource-policy\"",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mname\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.env\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-moose-instance-resource-policy\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 4,
                  "Content": "    policy = jsonencode(",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mpolicy\u001b[0m =\u001b[38;5;33m jsonencode\u001b[0m(",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 5,
                  "Content": "    {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 6,
                  "Content": "        \"Version\": \"2012-10-17\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;37m\"Version\"\u001b[0m\u001b[38;5;245m:\u001b[0m \u001b[38;5;37m\"2012-10-17\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 7,
                  "Content": "        \"Statement\": [",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;37m\"Statement\"\u001b[0m\u001b[38;5;245m:\u001b[0m [",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 8,
                  "Content": "            {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 9,
                  "Content": "            \"Sid\": \"dynamo\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;37m\"Sid\"\u001b[0m\u001b[38;5;245m:\u001b[0m \u001b[38;5;37m\"dynamo\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 10,
                  "Content": "            \"Effect\": \"Allow\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;37m\"Effect\"\u001b[0m\u001b[38;5;245m:\u001b[0m \u001b[38;5;37m\"Allow\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 11,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "aws_iam_policy.moose_instance_policy",
                "Filename": "iam.tf",
                "Location": {
                  "StartLine": 2,
                  "EndLine": 62
                }
              }
            ],
            "RenderedCause": {
              "Raw": "resource \"aws_iam_policy\" \"moose_instance_policy\" {\n  policy = \"{\\\"Statement\\\":[{\\\"Action\\\":[\\\"dynamodb:BatchGetItem\\\",\\\"dynamodb:BatchWriteItem\\\",\\\"dynamodb:PutItem\\\",\\\"dynamodb:ListTables\\\",\\\"dynamodb:DeleteItem\\\",\\\"dynamodb:PartiQLUpdate\\\",\\\"dynamodb:Query\\\",\\\"dynamodb:UpdateItem\\\",\\\"dynamodb:PartiQLSelect\\\",\\\"dynamodb:PartiQLInsert\\\",\\\"dynamodb:GetItem\\\",\\\"dynamodb:GetRecords\\\",\\\"dynamodb:PartiQLDelete\\\"],\\\"Effect\\\":\\\"Allow\\\",\\\"Resource\\\":[\\\"arn:aws:dynamodb:us-east-1:752380136218:table/development-mooseDataProd/index/*\\\",\\\"arn:aws:dynamodb:us-east-1:752380136218:table/development-mooseDataProd\\\",\\\"2ec2301d-0aee-4b6b-84f7-f7ab61d6f74d\\\",\\\"2ec2301d-0aee-4b6b-84f7-f7ab61d6f74d/index/*\\\"],\\\"Sid\\\":\\\"dynamo\\\"},{\\\"Action\\\":\\\"s3:*\\\",\\\"Effect\\\":\\\"Allow\\\",\\\"Resource\\\":[\\\"arn:aws:s3:::\\\",\\\"arn:aws:s3:::/*\\\"],\\\"Sid\\\":\\\"s3\\\"},{\\\"Action\\\":\\\"sqs:*\\\",\\\"Effect\\\":\\\"Allow\\\",\\\"Resource\\\":\\\"6aab0da3-3b24-408b-bd0f-6aed1c0e2c66\\\",\\\"Sid\\\":\\\"sqs\\\"},{\\\"Action\\\":\\\"secretsmanager:*\\\",\\\"Effect\\\":\\\"Allow\\\",\\\"Resource\\\":\\\"*\\\",\\\"Sid\\\":\\\"secretsmanager\\\"},{\\\"Action\\\":\\\"events:*\\\",\\\"Effect\\\":\\\"Allow\\\",\\\"Resource\\\":\\\"*\\\",\\\"Sid\\\":\\\"eventbridge\\\"}],\\\"Version\\\":\\\"2012-10-17\\\"}\"\n}",
              "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_iam_policy\"\u001b[0m \u001b[38;5;37m\"moose_instance_policy\"\u001b[0m {\n  \u001b[38;5;245mpolicy\u001b[0m = \u001b[38;5;37m\"{\u001b[0m\\\u001b[38;5;37m\"\u001b[0mStatement\\\u001b[38;5;37m\":[{\u001b[0m\\\u001b[38;5;37m\"\u001b[0mAction\\\u001b[38;5;37m\":[\u001b[0m\\\u001b[38;5;37m\"\u001b[0mdynamodb\u001b[38;5;245m:\u001b[0mBatchGetItem\\\u001b[38;5;37m\",\u001b[0m\\\u001b[38;5;37m\"\u001b[0mdynamodb\u001b[38;5;245m:\u001b[0mBatchWriteItem\\\u001b[38;5;37m\",\u001b[0m\\\u001b[38;5;37m\"\u001b[0mdynamodb\u001b[38;5;245m:\u001b[0mPutItem\\\u001b[38;5;37m\",\u001b[0m\\\u001b[38;5;37m\"\u001b[0mdynamodb\u001b[38;5;245m:\u001b[0mListTables\\\u001b[38;5;37m\",\u001b[0m\\\u001b[38;5;37m\"\u001b[0mdynamodb\u001b[38;5;245m:\u001b[0mDeleteItem\\\u001b[38;5;37m\",\u001b[0m\\\u001b[38;5;37m\"\u001b[0mdynamodb\u001b[38;5;245m:\u001b[0mPartiQLUpdate\\\u001b[38;5;37m\",\u001b[0m\\\u001b[38;5;37m\"\u001b[0mdynamodb\u001b[38;5;245m:\u001b[0mQuery\\\u001b[38;5;37m\",\u001b[0m\\\u001b[38;5;37m\"\u001b[0mdynamodb\u001b[38;5;245m:\u001b[0mUpdateItem\\\u001b[38;5;37m\",\u001b[0m\\\u001b[38;5;37m\"\u001b[0mdynamodb\u001b[38;5;245m:\u001b[0mPartiQLSelect\\\u001b[38;5;37m\",\u001b[0m\\\u001b[38;5;37m\"\u001b[0mdynamodb\u001b[38;5;245m:\u001b[0mPartiQLInsert\\\u001b[38;5;37m\",\u001b[0m\\\u001b[38;5;37m\"\u001b[0mdynamodb\u001b[38;5;245m:\u001b[0mGetItem\\\u001b[38;5;37m\",\u001b[0m\\\u001b[38;5;37m\"\u001b[0mdynamodb\u001b[38;5;245m:\u001b[0mGetRecords\\\u001b[38;5;37m\",\u001b[0m\\\u001b[38;5;37m\"\u001b[0mdynamodb\u001b[38;5;245m:\u001b[0mPartiQLDelete\\\u001b[38;5;37m\"],\u001b[0m\\\u001b[38;5;37m\"\u001b[0mEffect\\\u001b[38;5;37m\":\u001b[0m\\\u001b[38;5;37m\"\u001b[0mAllow\\\u001b[38;5;37m\",\u001b[0m\\\u001b[38;5;37m\"\u001b[0mResource\\\u001b[38;5;37m\":[\u001b[0m\\\u001b[38;5;37m\"\u001b[0marn\u001b[38;5;245m:\u001b[0maws\u001b[38;5;245m:\u001b[0mdynamodb\u001b[38;5;245m:\u001b[0mus\u001b[38;5;245m-\u001b[0meast\u001b[38;5;37m-1\u001b[0m\u001b[38;5;245m:\u001b[0m\u001b[38;5;37m752380136218\u001b[0m\u001b[38;5;245m:\u001b[0mtable\u001b[38;5;245m/\u001b[0mdevelopment\u001b[38;5;245m-\u001b[0mmooseDataProd\u001b[38;5;33m/index\u001b[0m\u001b[38;5;245m/*\u001b[0m\\\u001b[38;5;37m\",\u001b[0m\\\u001b[38;5;37m\"\u001b[0marn\u001b[38;5;245m:\u001b[0maws\u001b[38;5;245m:\u001b[0mdynamodb\u001b[38;5;245m:\u001b[0mus\u001b[38;5;245m-\u001b[0meast\u001b[38;5;37m-1\u001b[0m\u001b[38;5;245m:\u001b[0m\u001b[38;5;37m752380136218\u001b[0m\u001b[38;5;245m:\u001b[0mtable\u001b[38;5;245m/\u001b[0mdevelopment\u001b[38;5;245m-\u001b[0mmooseDataProd\\\u001b[38;5;37m\",\u001b[0m\\\u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m2\u001b[0mec2301d\u001b[38;5;37m-0\u001b[0maee\u001b[38;5;37m-4\u001b[0mb6b\u001b[38;5;37m-84\u001b[0mf7\u001b[38;5;245m-\u001b[0mf7ab61d6f74d\\\u001b[38;5;37m\",\u001b[0m\\\u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m2\u001b[0mec2301d\u001b[38;5;37m-0\u001b[0maee\u001b[38;5;37m-4\u001b[0mb6b\u001b[38;5;37m-84\u001b[0mf7\u001b[38;5;245m-\u001b[0mf7ab61d6f74d\u001b[38;5;33m/index\u001b[0m\u001b[38;5;245m/*\u001b[0m\\\u001b[38;5;37m\"],\u001b[0m\\\u001b[38;5;37m\"\u001b[0mSid\\\u001b[38;5;37m\":\u001b[0m\\\u001b[38;5;37m\"\u001b[0mdynamo\\\u001b[38;5;37m\"},{\u001b[0m\\\u001b[38;5;37m\"\u001b[0mAction\\\u001b[38;5;37m\":\u001b[0m\\\u001b[38;5;37m\"\u001b[0ms3\u001b[38;5;245m:*\u001b[0m\\\u001b[38;5;37m\",\u001b[0m\\\u001b[38;5;37m\"\u001b[0mEffect\\\u001b[38;5;37m\":\u001b[0m\\\u001b[38;5;37m\"\u001b[0mAllow\\\u001b[38;5;37m\",\u001b[0m\\\u001b[38;5;37m\"\u001b[0mResource\\\u001b[38;5;37m\":[\u001b[0m\\\u001b[38;5;37m\"\u001b[0marn\u001b[38;5;245m:\u001b[0maws\u001b[38;5;245m:\u001b[0ms3\u001b[38;5;245m:::\u001b[0m\\\u001b[38;5;37m\",\u001b[0m\\\u001b[38;5;37m\"\u001b[0marn\u001b[38;5;245m:\u001b[0maws\u001b[38;5;245m:\u001b[0ms3\u001b[38;5;245m:::/*\u001b[0m\\\u001b[38;5;37m\"],\u001b[0m\\\u001b[38;5;37m\"\u001b[0mSid\\\u001b[38;5;37m\":\u001b[0m\\\u001b[38;5;37m\"\u001b[0ms3\\\u001b[38;5;37m\"},{\u001b[0m\\\u001b[38;5;37m\"\u001b[0mAction\\\u001b[38;5;37m\":\u001b[0m\\\u001b[38;5;37m\"\u001b[0msqs\u001b[38;5;245m:*\u001b[0m\\\u001b[38;5;37m\",\u001b[0m\\\u001b[38;5;37m\"\u001b[0mEffect\\\u001b[38;5;37m\":\u001b[0m\\\u001b[38;5;37m\"\u001b[0mAllow\\\u001b[38;5;37m\",\u001b[0m\\\u001b[38;5;37m\"\u001b[0mResource\\\u001b[38;5;37m\":\u001b[0m\\\u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m6\u001b[0maab0da3\u001b[38;5;37m-3\u001b[0mb24\u001b[38;5;37m-408\u001b[0mb\u001b[38;5;245m-\u001b[0mbd0f\u001b[38;5;37m-6\u001b[0maed1c0e2c66\\\u001b[38;5;37m\",\u001b[0m\\\u001b[38;5;37m\"\u001b[0mSid\\\u001b[38;5;37m\":\u001b[0m\\\u001b[38;5;37m\"\u001b[0msqs\\\u001b[38;5;37m\"},{\u001b[0m\\\u001b[38;5;37m\"\u001b[0mAction\\\u001b[38;5;37m\":\u001b[0m\\\u001b[38;5;37m\"\u001b[0msecretsmanager\u001b[38;5;245m:*\u001b[0m\\\u001b[38;5;37m\",\u001b[0m\\\u001b[38;5;37m\"\u001b[0mEffect\\\u001b[38;5;37m\":\u001b[0m\\\u001b[38;5;37m\"\u001b[0mAllow\\\u001b[38;5;37m\",\u001b[0m\\\u001b[38;5;37m\"\u001b[0mResource\\\u001b[38;5;37m\":\u001b[0m\\\u001b[38;5;37m\"\u001b[0m\u001b[38;5;245m*\u001b[0m\\\u001b[38;5;37m\",\u001b[0m\\\u001b[38;5;37m\"\u001b[0mSid\\\u001b[38;5;37m\":\u001b[0m\\\u001b[38;5;37m\"\u001b[0msecretsmanager\\\u001b[38;5;37m\"},{\u001b[0m\\\u001b[38;5;37m\"\u001b[0mAction\\\u001b[38;5;37m\":\u001b[0m\\\u001b[38;5;37m\"\u001b[0mevents\u001b[38;5;245m:*\u001b[0m\\\u001b[38;5;37m\",\u001b[0m\\\u001b[38;5;37m\"\u001b[0mEffect\\\u001b[38;5;37m\":\u001b[0m\\\u001b[38;5;37m\"\u001b[0mAllow\\\u001b[38;5;37m\",\u001b[0m\\\u001b[38;5;37m\"\u001b[0mResource\\\u001b[38;5;37m\":\u001b[0m\\\u001b[38;5;37m\"\u001b[0m\u001b[38;5;245m*\u001b[0m\\\u001b[38;5;37m\",\u001b[0m\\\u001b[38;5;37m\"\u001b[0mSid\\\u001b[38;5;37m\":\u001b[0m\\\u001b[38;5;37m\"\u001b[0meventbridge\\\u001b[38;5;37m\"}],\u001b[0m\\\u001b[38;5;37m\"\u001b[0mVersion\\\u001b[38;5;37m\":\u001b[0m\\\u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m2012-10-17\u001b[0m\\\u001b[38;5;37m\"}\"\n\u001b[0m}"
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0345",
          "AVDID": "AVD-AWS-0345",
          "Title": "Disallow unrestricted S3 IAM Policies",
          "Description": "Ensure that the creation of the unrestricted S3 IAM policies is disallowed.",
          "Message": "IAM policy allows 's3:*' action",
          "Namespace": "builtin.aws.iam.aws0345",
          "Query": "data.builtin.aws.iam.aws0345.deny",
          "Resolution": "Create more restrictive S3 policies",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0345",
          "References": [
            "https://avd.aquasec.com/misconfig/avd-aws-0345"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_iam_policy.moose_instance_policy_s3",
            "Provider": "AWS",
            "Service": "iam",
            "StartLine": 101,
            "EndLine": 121,
            "Code": {
              "Lines": [
                {
                  "Number": 99,
                  "Content": "resource \"aws_iam_policy\" \"moose_instance_policy_s3\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_iam_policy\"\u001b[0m \u001b[38;5;37m\"moose_instance_policy_s3\"\u001b[0m {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 100,
                  "Content": "    name = \"${var.env}-moose-instance-resource-policy_s3\"",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mname\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.env\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-moose-instance-resource-policy_s3\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 101,
                  "Content": "    policy = jsonencode(",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mpolicy\u001b[0m =\u001b[38;5;33m jsonencode\u001b[0m(",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 102,
                  "Content": "    {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 103,
                  "Content": "        \"Version\": \"2012-10-17\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;37m\"Version\"\u001b[0m\u001b[38;5;245m:\u001b[0m \u001b[38;5;37m\"2012-10-17\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 104,
                  "Content": "        \"Statement\": [",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;37m\"Statement\"\u001b[0m\u001b[38;5;245m:\u001b[0m [",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 105,
                  "Content": "            {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 106,
                  "Content": "            \"Sid\": \"s3\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;37m\"Sid\"\u001b[0m\u001b[38;5;245m:\u001b[0m \u001b[38;5;37m\"s3\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 107,
                  "Content": "            \"Effect\": \"Allow\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;37m\"Effect\"\u001b[0m\u001b[38;5;245m:\u001b[0m \u001b[38;5;37m\"Allow\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 108,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "aws_iam_policy.moose_instance_policy_s3",
                "Filename": "iam.tf",
                "Location": {
                  "StartLine": 99,
                  "EndLine": 122
                }
              }
            ],
            "RenderedCause": {
              "Raw": "resource \"aws_iam_policy\" \"moose_instance_policy_s3\" {\n  policy = \"{\\\"Statement\\\":[{\\\"Action\\\":\\\"s3:*\\\",\\\"Effect\\\":\\\"Allow\\\",\\\"Resource\\\":[\\\"arn:aws:s3:::\\\",\\\"arn:aws:s3:::/*\\\",\\\"arn:aws:s3:::\\\",\\\"arn:aws:s3:::/*\\\",\\\"arn:aws:s3:::\\\",\\\"arn:aws:s3:::/*\\\"],\\\"Sid\\\":\\\"s3\\\"}],\\\"Version\\\":\\\"2012-10-17\\\"}\"\n}",
              "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_iam_policy\"\u001b[0m \u001b[38;5;37m\"moose_instance_policy_s3\"\u001b[0m {\n  \u001b[38;5;245mpolicy\u001b[0m = \u001b[38;5;37m\"{\u001b[0m\\\u001b[38;5;37m\"\u001b[0mStatement\\\u001b[38;5;37m\":[{\u001b[0m\\\u001b[38;5;37m\"\u001b[0mAction\\\u001b[38;5;37m\":\u001b[0m\\\u001b[38;5;37m\"\u001b[0ms3\u001b[38;5;245m:*\u001b[0m\\\u001b[38;5;37m\",\u001b[0m\\\u001b[38;5;37m\"\u001b[0mEffect\\\u001b[38;5;37m\":\u001b[0m\\\u001b[38;5;37m\"\u001b[0mAllow\\\u001b[38;5;37m\",\u001b[0m\\\u001b[38;5;37m\"\u001b[0mResource\\\u001b[38;5;37m\":[\u001b[0m\\\u001b[38;5;37m\"\u001b[0marn\u001b[38;5;245m:\u001b[0maws\u001b[38;5;245m:\u001b[0ms3\u001b[38;5;245m:::\u001b[0m\\\u001b[38;5;37m\",\u001b[0m\\\u001b[38;5;37m\"\u001b[0marn\u001b[38;5;245m:\u001b[0maws\u001b[38;5;245m:\u001b[0ms3\u001b[38;5;245m:::/*\u001b[0m\\\u001b[38;5;37m\",\u001b[0m\\\u001b[38;5;37m\"\u001b[0marn\u001b[38;5;245m:\u001b[0maws\u001b[38;5;245m:\u001b[0ms3\u001b[38;5;245m:::\u001b[0m\\\u001b[38;5;37m\",\u001b[0m\\\u001b[38;5;37m\"\u001b[0marn\u001b[38;5;245m:\u001b[0maws\u001b[38;5;245m:\u001b[0ms3\u001b[38;5;245m:::/*\u001b[0m\\\u001b[38;5;37m\",\u001b[0m\\\u001b[38;5;37m\"\u001b[0marn\u001b[38;5;245m:\u001b[0maws\u001b[38;5;245m:\u001b[0ms3\u001b[38;5;245m:::\u001b[0m\\\u001b[38;5;37m\",\u001b[0m\\\u001b[38;5;37m\"\u001b[0marn\u001b[38;5;245m:\u001b[0maws\u001b[38;5;245m:\u001b[0ms3\u001b[38;5;245m:::/*\u001b[0m\\\u001b[38;5;37m\"],\u001b[0m\\\u001b[38;5;37m\"\u001b[0mSid\\\u001b[38;5;37m\":\u001b[0m\\\u001b[38;5;37m\"\u001b[0ms3\\\u001b[38;5;37m\"}],\u001b[0m\\\u001b[38;5;37m\"\u001b[0mVersion\\\u001b[38;5;37m\":\u001b[0m\\\u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m2012-10-17\u001b[0m\\\u001b[38;5;37m\"}\"\n\u001b[0m}"
            }
          }
        }
      ]
    },
    {
      "Target": "opensearch/main.tf",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 0,
        "Failures": 1
      },
      "Misconfigurations": [
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0042",
          "AVDID": "AVD-AWS-0042",
          "Title": "Domain logging should be enabled for Elastic Search domains",
          "Description": "Amazon ES exposes four Elasticsearch logs through Amazon CloudWatch Logs: error logs, search slow logs, index slow logs, and audit logs.\nSearch slow logs, index slow logs, and error logs are useful for troubleshooting performance and stability issues.\nAudit logs track user activity for compliance purposes.\nAll the logs are disabled by default.\n",
          "Message": "Domain audit logging is not enabled.",
          "Namespace": "builtin.aws.elasticsearch.aws0042",
          "Query": "data.builtin.aws.elasticsearch.aws0042.deny",
          "Resolution": "Enable logging for ElasticSearch domains",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0042",
          "References": [
            "https://docs.aws.amazon.com/elasticsearch-service/latest/developerguide/es-createdomain-configure-slow-logs.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0042"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "module.opensearch",
            "Provider": "AWS",
            "Service": "elasticsearch",
            "StartLine": 33,
            "EndLine": 98,
            "Code": {
              "Lines": [
                {
                  "Number": 33,
                  "Content": "resource \"aws_opensearch_domain\" \"opensearch_domain\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_opensearch_domain\"\u001b[0m \u001b[38;5;37m\"opensearch_domain\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 34,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 35,
                  "Content": "  lifecycle {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  lifecycle {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 36,
                  "Content": "    ignore_changes = [",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mignore_changes\u001b[0m = [",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 37,
                  "Content": "      # Ignore changes to tags, e.g. because a management agent",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;239m      # Ignore changes to tags, e.g. because a management agent",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 38,
                  "Content": "      # updates these based on some ruleset managed elsewhere.",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      # updates these based on some ruleset managed elsewhere.",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 39,
                  "Content": "      access_policies",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      access_policies",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 40,
                  "Content": "    ]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    ]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 41,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  }",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 42,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "module.opensearch",
                "Filename": "opensearch.tf",
                "Location": {
                  "StartLine": 10,
                  "EndLine": 22
                }
              }
            ],
            "RenderedCause": {}
          }
        }
      ]
    },
    {
      "Target": "s3.tf",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 0,
        "Failures": 9
      },
      "Misconfigurations": [
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0086",
          "AVDID": "AVD-AWS-0086",
          "Title": "S3 Access block should block public ACL",
          "Description": "S3 buckets should block public ACLs on buckets and any objects they contain. By blocking, PUTs with fail if the object has any public ACL a.\n",
          "Message": "No public access block so not blocking public acls",
          "Namespace": "builtin.aws.s3.aws0086",
          "Query": "data.builtin.aws.s3.aws0086.deny",
          "Resolution": "Enable blocking any PUT calls with a public ACL specified",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0086",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0086"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.presigned",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 1,
            "EndLine": 10,
            "Code": {
              "Lines": [
                {
                  "Number": 1,
                  "Content": "resource \"aws_s3_bucket\" \"presigned\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"presigned\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 2,
                  "Content": "  bucket = \"${var.env}-presigned-bucket\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.env\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-presigned-bucket\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 3,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 4,
                  "Content": "  force_destroy = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mforce_destroy\u001b[0m = \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 5,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 6,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mtags\u001b[0m = {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 7,
                  "Content": "    Name        = \"${var.env}-presigned-bucket\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mName\u001b[0m        = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.env\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-presigned-bucket\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 8,
                  "Content": "    Environment = var.env",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;33mvar\u001b[0m.env",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 9,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  }",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 10,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0087",
          "AVDID": "AVD-AWS-0087",
          "Title": "S3 Access block should block public policy",
          "Description": "S3 bucket policy should have block public policy to prevent users from putting a policy that enable public access.\n",
          "Message": "No public access block so not blocking public policies",
          "Namespace": "builtin.aws.s3.aws0087",
          "Query": "data.builtin.aws.s3.aws0087.deny",
          "Resolution": "Prevent policies that allow public access being PUT",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0087",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/dev-retired/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0087"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.presigned",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 1,
            "EndLine": 10,
            "Code": {
              "Lines": [
                {
                  "Number": 1,
                  "Content": "resource \"aws_s3_bucket\" \"presigned\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"presigned\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 2,
                  "Content": "  bucket = \"${var.env}-presigned-bucket\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.env\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-presigned-bucket\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 3,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 4,
                  "Content": "  force_destroy = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mforce_destroy\u001b[0m = \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 5,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 6,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mtags\u001b[0m = {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 7,
                  "Content": "    Name        = \"${var.env}-presigned-bucket\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mName\u001b[0m        = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.env\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-presigned-bucket\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 8,
                  "Content": "    Environment = var.env",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;33mvar\u001b[0m.env",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 9,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  }",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 10,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0088",
          "AVDID": "AVD-AWS-0088",
          "Title": "Unencrypted S3 bucket.",
          "Description": "S3 Buckets should be encrypted to protect the data that is stored within them if access is compromised.\n",
          "Message": "Bucket does not have encryption enabled",
          "Namespace": "builtin.aws.s3.aws0088",
          "Query": "data.builtin.aws.s3.aws0088.deny",
          "Resolution": "Configure bucket encryption",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0088",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/bucket-encryption.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0088"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.presigned",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 1,
            "EndLine": 10,
            "Code": {
              "Lines": [
                {
                  "Number": 1,
                  "Content": "resource \"aws_s3_bucket\" \"presigned\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"presigned\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 2,
                  "Content": "  bucket = \"${var.env}-presigned-bucket\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.env\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-presigned-bucket\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 3,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 4,
                  "Content": "  force_destroy = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mforce_destroy\u001b[0m = \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 5,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 6,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mtags\u001b[0m = {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 7,
                  "Content": "    Name        = \"${var.env}-presigned-bucket\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mName\u001b[0m        = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.env\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-presigned-bucket\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 8,
                  "Content": "    Environment = var.env",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;33mvar\u001b[0m.env",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 9,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  }",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 10,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "s3-bucket-logging",
          "AVDID": "AVD-AWS-0089",
          "Title": "S3 Bucket Logging",
          "Description": "Ensures S3 bucket logging is enabled for S3 buckets",
          "Message": "Bucket has logging disabled",
          "Namespace": "builtin.aws.s3.aws0089",
          "Query": "data.builtin.aws.s3.aws0089.deny",
          "Resolution": "Add a logging block to the resource to enable access logging",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/s3-bucket-logging",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/ServerLogs.html",
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/enable-server-access-logging.html",
            "https://avd.aquasec.com/misconfig/s3-bucket-logging"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.presigned",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 1,
            "EndLine": 10,
            "Code": {
              "Lines": [
                {
                  "Number": 1,
                  "Content": "resource \"aws_s3_bucket\" \"presigned\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"presigned\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 2,
                  "Content": "  bucket = \"${var.env}-presigned-bucket\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.env\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-presigned-bucket\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 3,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 4,
                  "Content": "  force_destroy = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mforce_destroy\u001b[0m = \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 5,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 6,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mtags\u001b[0m = {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 7,
                  "Content": "    Name        = \"${var.env}-presigned-bucket\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mName\u001b[0m        = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.env\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-presigned-bucket\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 8,
                  "Content": "    Environment = var.env",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;33mvar\u001b[0m.env",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 9,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  }",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 10,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0090",
          "AVDID": "AVD-AWS-0090",
          "Title": "S3 Data should be versioned",
          "Description": "Versioning in Amazon S3 is a means of keeping multiple variants of an object in the same bucket.\n\nYou can use the S3 Versioning feature to preserve, retrieve, and restore every version of every object stored in your buckets.\n\nWith versioning you can recover more easily from both unintended user actions and application failures.\n\nWhen you enable versioning, also keep in mind the potential costs of storing noncurrent versions of objects. To help manage those costs, consider setting up an S3 Lifecycle configuration.\n",
          "Message": "Bucket does not have versioning enabled",
          "Namespace": "builtin.aws.s3.aws0090",
          "Query": "data.builtin.aws.s3.aws0090.deny",
          "Resolution": "Enable versioning to protect against accidental/malicious removal or modification",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0090",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/Versioning.html",
            "https://aws.amazon.com/blogs/storage/reduce-storage-costs-with-fewer-noncurrent-versions-using-amazon-s3-lifecycle/",
            "https://avd.aquasec.com/misconfig/avd-aws-0090"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.presigned",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 1,
            "EndLine": 10,
            "Code": {
              "Lines": [
                {
                  "Number": 1,
                  "Content": "resource \"aws_s3_bucket\" \"presigned\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"presigned\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 2,
                  "Content": "  bucket = \"${var.env}-presigned-bucket\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.env\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-presigned-bucket\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 3,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 4,
                  "Content": "  force_destroy = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mforce_destroy\u001b[0m = \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 5,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 6,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mtags\u001b[0m = {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 7,
                  "Content": "    Name        = \"${var.env}-presigned-bucket\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mName\u001b[0m        = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.env\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-presigned-bucket\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 8,
                  "Content": "    Environment = var.env",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;33mvar\u001b[0m.env",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 9,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  }",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 10,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0091",
          "AVDID": "AVD-AWS-0091",
          "Title": "S3 Access Block should Ignore Public ACL",
          "Description": "S3 buckets should ignore public ACLs on buckets and any objects they contain. By ignoring rather than blocking, PUT calls with public ACLs will still be applied but the ACL will be ignored.\n",
          "Message": "No public access block so not blocking public acls",
          "Namespace": "builtin.aws.s3.aws0091",
          "Query": "data.builtin.aws.s3.aws0091.deny",
          "Resolution": "Enable ignoring the application of public ACLs in PUT calls",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0091",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0091"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.presigned",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 1,
            "EndLine": 10,
            "Code": {
              "Lines": [
                {
                  "Number": 1,
                  "Content": "resource \"aws_s3_bucket\" \"presigned\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"presigned\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 2,
                  "Content": "  bucket = \"${var.env}-presigned-bucket\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.env\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-presigned-bucket\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 3,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 4,
                  "Content": "  force_destroy = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mforce_destroy\u001b[0m = \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 5,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 6,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mtags\u001b[0m = {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 7,
                  "Content": "    Name        = \"${var.env}-presigned-bucket\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mName\u001b[0m        = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.env\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-presigned-bucket\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 8,
                  "Content": "    Environment = var.env",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;33mvar\u001b[0m.env",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 9,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  }",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 10,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0093",
          "AVDID": "AVD-AWS-0093",
          "Title": "S3 Access block should restrict public bucket to limit access",
          "Description": "S3 buckets should restrict public policies for the bucket. By enabling, the restrict_public_buckets, only the bucket owner and AWS Services can access if it has a public policy.\n",
          "Message": "No public access block so not restricting public buckets",
          "Namespace": "builtin.aws.s3.aws0093",
          "Query": "data.builtin.aws.s3.aws0093.deny",
          "Resolution": "Limit the access to public buckets to only the owner or AWS Services (eg; CloudFront)",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0093",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/dev-retired/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0093"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.presigned",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 1,
            "EndLine": 10,
            "Code": {
              "Lines": [
                {
                  "Number": 1,
                  "Content": "resource \"aws_s3_bucket\" \"presigned\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"presigned\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 2,
                  "Content": "  bucket = \"${var.env}-presigned-bucket\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.env\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-presigned-bucket\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 3,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 4,
                  "Content": "  force_destroy = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mforce_destroy\u001b[0m = \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 5,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 6,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mtags\u001b[0m = {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 7,
                  "Content": "    Name        = \"${var.env}-presigned-bucket\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mName\u001b[0m        = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.env\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-presigned-bucket\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 8,
                  "Content": "    Environment = var.env",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;33mvar\u001b[0m.env",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 9,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  }",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 10,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0094",
          "AVDID": "AVD-AWS-0094",
          "Title": "S3 buckets should each define an aws_s3_bucket_public_access_block",
          "Description": "The \"block public access\" settings in S3 override individual policies that apply to a given bucket, meaning that all public access can be controlled in one central types for that bucket. It is therefore good practice to define these settings for each bucket in order to clearly define the public access that can be allowed for it.\n",
          "Message": "Bucket does not have a corresponding public access block.",
          "Namespace": "builtin.aws.s3.aws0094",
          "Query": "data.builtin.aws.s3.aws0094.deny",
          "Resolution": "Define a aws_s3_bucket_public_access_block for the given bucket to control public access policies",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0094",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0094"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.presigned",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 1,
            "EndLine": 10,
            "Code": {
              "Lines": [
                {
                  "Number": 1,
                  "Content": "resource \"aws_s3_bucket\" \"presigned\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"presigned\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 2,
                  "Content": "  bucket = \"${var.env}-presigned-bucket\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.env\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-presigned-bucket\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 3,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 4,
                  "Content": "  force_destroy = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mforce_destroy\u001b[0m = \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 5,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 6,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mtags\u001b[0m = {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 7,
                  "Content": "    Name        = \"${var.env}-presigned-bucket\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mName\u001b[0m        = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.env\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-presigned-bucket\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 8,
                  "Content": "    Environment = var.env",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;33mvar\u001b[0m.env",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 9,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  }",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 10,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0132",
          "AVDID": "AVD-AWS-0132",
          "Title": "S3 encryption should use Customer Managed Keys",
          "Description": "Encryption using AWS keys provides protection for your S3 buckets. To increase control of the encryption and manage factors like rotation use customer managed keys.\n",
          "Message": "Bucket does not encrypt data with a customer managed key.",
          "Namespace": "builtin.aws.s3.aws0132",
          "Query": "data.builtin.aws.s3.aws0132.deny",
          "Resolution": "Enable encryption using customer managed keys",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0132",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/bucket-encryption.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0132"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.presigned",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 1,
            "EndLine": 10,
            "Code": {
              "Lines": [
                {
                  "Number": 1,
                  "Content": "resource \"aws_s3_bucket\" \"presigned\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"presigned\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 2,
                  "Content": "  bucket = \"${var.env}-presigned-bucket\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.env\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-presigned-bucket\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 3,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 4,
                  "Content": "  force_destroy = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mforce_destroy\u001b[0m = \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 5,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 6,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mtags\u001b[0m = {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 7,
                  "Content": "    Name        = \"${var.env}-presigned-bucket\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mName\u001b[0m        = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.env\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-presigned-bucket\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 8,
                  "Content": "    Environment = var.env",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;33mvar\u001b[0m.env",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 9,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  }",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 10,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            },
            "RenderedCause": {}
          }
        }
      ]
    },
    {
      "Target": "terraform-aws-modules/vpc/aws/.terraform/modules/moose_fargate.vpc/main.tf",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 0,
        "Failures": 3
      },
      "Misconfigurations": [
        {
          "Type": "Terraform Security Check",
          "ID": "aws-vpc-no-public-ingress-sgr",
          "AVDID": "AVD-AWS-0164",
          "Title": "Instances in a subnet should not receive a public IP address by default.",
          "Description": "You should limit the provision of public IP addresses for resources. Resources should not be exposed on the public internet, but should have access limited to consumers required for the function of your application.\n",
          "Message": "Subnet associates public IP address.",
          "Namespace": "builtin.aws.ec2.aws0164",
          "Query": "data.builtin.aws.ec2.aws0164.deny",
          "Resolution": "Set the instance to not be publicly accessible",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/aws-vpc-no-public-ingress-sgr",
          "References": [
            "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-instance-addressing.html#concepts-public-addresses",
            "https://avd.aquasec.com/misconfig/aws-vpc-no-public-ingress-sgr"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "module.moose_fargate",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 110,
            "EndLine": 110,
            "Code": {
              "Lines": [
                {
                  "Number": 98,
                  "Content": "resource \"aws_subnet\" \"public\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_subnet\"\u001b[0m \u001b[38;5;37m\"public\"\u001b[0m {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 99,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 110,
                  "Content": "  map_public_ip_on_launch                        = var.map_public_ip_on_launch",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mmap_public_ip_on_launch\u001b[0m                        = \u001b[38;5;33mvar\u001b[0m.map_public_ip_on_launch",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 124,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 125,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "aws_subnet.public[0]",
                "Filename": "terraform-aws-modules/vpc/aws/.terraform/modules/moose_fargate.vpc/main.tf",
                "Location": {
                  "StartLine": 98,
                  "EndLine": 125
                }
              },
              {
                "Resource": "module.vpc",
                "Filename": "fargate/modules.tf",
                "Location": {
                  "StartLine": 3,
                  "EndLine": 18
                }
              },
              {
                "Resource": "module.moose_fargate",
                "Filename": "app.tf",
                "Location": {
                  "StartLine": 8,
                  "EndLine": 39
                }
              }
            ],
            "RenderedCause": {
              "Raw": "resource \"aws_subnet\" \"public\" {\n  map_public_ip_on_launch = true\n}",
              "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_subnet\"\u001b[0m \u001b[38;5;37m\"public\"\u001b[0m {\n  \u001b[38;5;245mmap_public_ip_on_launch\u001b[0m = \u001b[38;5;166mtrue\n\u001b[0m}"
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "aws-vpc-no-public-ingress-sgr",
          "AVDID": "AVD-AWS-0164",
          "Title": "Instances in a subnet should not receive a public IP address by default.",
          "Description": "You should limit the provision of public IP addresses for resources. Resources should not be exposed on the public internet, but should have access limited to consumers required for the function of your application.\n",
          "Message": "Subnet associates public IP address.",
          "Namespace": "builtin.aws.ec2.aws0164",
          "Query": "data.builtin.aws.ec2.aws0164.deny",
          "Resolution": "Set the instance to not be publicly accessible",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/aws-vpc-no-public-ingress-sgr",
          "References": [
            "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-instance-addressing.html#concepts-public-addresses",
            "https://avd.aquasec.com/misconfig/aws-vpc-no-public-ingress-sgr"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "module.moose_fargate",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 110,
            "EndLine": 110,
            "Code": {
              "Lines": [
                {
                  "Number": 98,
                  "Content": "resource \"aws_subnet\" \"public\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_subnet\"\u001b[0m \u001b[38;5;37m\"public\"\u001b[0m {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 99,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 110,
                  "Content": "  map_public_ip_on_launch                        = var.map_public_ip_on_launch",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mmap_public_ip_on_launch\u001b[0m                        = \u001b[38;5;33mvar\u001b[0m.map_public_ip_on_launch",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 124,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 125,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "aws_subnet.public[1]",
                "Filename": "terraform-aws-modules/vpc/aws/.terraform/modules/moose_fargate.vpc/main.tf",
                "Location": {
                  "StartLine": 98,
                  "EndLine": 125
                }
              },
              {
                "Resource": "module.vpc",
                "Filename": "fargate/modules.tf",
                "Location": {
                  "StartLine": 3,
                  "EndLine": 18
                }
              },
              {
                "Resource": "module.moose_fargate",
                "Filename": "app.tf",
                "Location": {
                  "StartLine": 8,
                  "EndLine": 39
                }
              }
            ],
            "RenderedCause": {
              "Raw": "resource \"aws_subnet\" \"public\" {\n  map_public_ip_on_launch = true\n}",
              "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_subnet\"\u001b[0m \u001b[38;5;37m\"public\"\u001b[0m {\n  \u001b[38;5;245mmap_public_ip_on_launch\u001b[0m = \u001b[38;5;166mtrue\n\u001b[0m}"
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "aws-autoscaling-enable-at-rest-encryption",
          "AVDID": "AVD-AWS-0178",
          "Title": "VPC Flow Logs is a feature that enables you to capture information about the IP traffic going to and from network interfaces in your VPC. After you've created a flow log, you can view and retrieve its data in Amazon CloudWatch Logs. It is recommended that VPC Flow Logs be enabled for packet \"Rejects\" for VPCs.",
          "Description": "VPC Flow Logs provide visibility into network traffic that traverses the VPC and can be used to detect anomalous traffic or insight during security workflows.\n",
          "Message": "VPC does not have VPC Flow Logs enabled.",
          "Namespace": "builtin.aws.ec2.aws0178",
          "Query": "data.builtin.aws.ec2.aws0178.deny",
          "Resolution": "Enable flow logs for VPC",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/aws-autoscaling-enable-at-rest-encryption",
          "References": [
            "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/RootDeviceStorage.html",
            "https://avd.aquasec.com/misconfig/aws-autoscaling-enable-at-rest-encryption"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "module.moose_fargate",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 29,
            "EndLine": 52,
            "Code": {
              "Lines": [
                {
                  "Number": 29,
                  "Content": "resource \"aws_vpc\" \"this\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_vpc\"\u001b[0m \u001b[38;5;37m\"this\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 30,
                  "Content": "  count = local.create_vpc ? 1 : 0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mcount\u001b[0m = local.create_vpc \u001b[38;5;245m?\u001b[0m \u001b[38;5;37m1\u001b[0m \u001b[38;5;245m:\u001b[0m \u001b[38;5;37m0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 31,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 32,
                  "Content": "  cidr_block          = var.use_ipam_pool ? null : var.cidr",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mcidr_block\u001b[0m          = \u001b[38;5;33mvar\u001b[0m.use_ipam_pool \u001b[38;5;245m?\u001b[0m null \u001b[38;5;245m:\u001b[0m \u001b[38;5;33mvar\u001b[0m.cidr",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 33,
                  "Content": "  ipv4_ipam_pool_id   = var.ipv4_ipam_pool_id",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mipv4_ipam_pool_id\u001b[0m   = \u001b[38;5;33mvar\u001b[0m.ipv4_ipam_pool_id",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 34,
                  "Content": "  ipv4_netmask_length = var.ipv4_netmask_length",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mipv4_netmask_length\u001b[0m = \u001b[38;5;33mvar\u001b[0m.ipv4_netmask_length",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 35,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 36,
                  "Content": "  assign_generated_ipv6_cidr_block     = var.enable_ipv6 \u0026\u0026 !var.use_ipam_pool ? true : null",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245massign_generated_ipv6_cidr_block\u001b[0m     = \u001b[38;5;33mvar\u001b[0m.enable_ipv6 \u001b[38;5;245m\u0026\u0026\u001b[0m \u001b[38;5;245m!\u001b[0m\u001b[38;5;33mvar\u001b[0m.use_ipam_pool \u001b[38;5;245m?\u001b[0m \u001b[38;5;166mtrue\u001b[0m \u001b[38;5;245m:\u001b[0m null",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 37,
                  "Content": "  ipv6_cidr_block                      = var.ipv6_cidr",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mipv6_cidr_block\u001b[0m                      = \u001b[38;5;33mvar\u001b[0m.ipv6_cidr",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 38,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "module.vpc",
                "Filename": "fargate/modules.tf",
                "Location": {
                  "StartLine": 3,
                  "EndLine": 18
                }
              },
              {
                "Resource": "module.moose_fargate",
                "Filename": "app.tf",
                "Location": {
                  "StartLine": 8,
                  "EndLine": 39
                }
              }
            ],
            "RenderedCause": {}
          }
        }
      ]
    },
    {
      "Target": "umotif-public/bastion/aws/.terraform/modules/bastion/main.tf",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 0,
        "Failures": 8
      },
      "Misconfigurations": [
        {
          "Type": "Terraform Security Check",
          "ID": "aws-vpc-add-description-to-security-group",
          "AVDID": "AVD-AWS-0099",
          "Title": "Missing description for security group.",
          "Description": "Security groups should include a description for auditing purposes.\n\nSimplifies auditing, debugging, and managing security groups.\n",
          "Message": "Security group explicitly uses the default description.",
          "Namespace": "builtin.aws.ec2.aws0099",
          "Query": "data.builtin.aws.ec2.aws0099.deny",
          "Resolution": "Add descriptions for all security groups",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/aws-vpc-add-description-to-security-group",
          "References": [
            "https://www.cloudconformity.com/knowledge-base/aws/EC2/security-group-rules-description.html",
            "https://avd.aquasec.com/misconfig/aws-vpc-add-description-to-security-group"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "module.bastion",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 124,
            "EndLine": 156,
            "Code": {
              "Lines": [
                {
                  "Number": 124,
                  "Content": "resource \"aws_security_group\" \"bastion\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_security_group\"\u001b[0m \u001b[38;5;37m\"bastion\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 125,
                  "Content": "  name_prefix = \"${var.name_prefix}-bastion-ssh-\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mname_prefix\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.name_prefix\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-bastion-ssh-\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 126,
                  "Content": "  vpc_id      = var.vpc_id",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mvpc_id\u001b[0m      = \u001b[38;5;33mvar\u001b[0m.vpc_id",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 127,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 128,
                  "Content": "  ingress {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  ingress {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 129,
                  "Content": "    from_port        = var.ssh_port",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mfrom_port\u001b[0m        = \u001b[38;5;33mvar\u001b[0m.ssh_port",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 130,
                  "Content": "    to_port          = var.ssh_port",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mto_port\u001b[0m          = \u001b[38;5;33mvar\u001b[0m.ssh_port",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 131,
                  "Content": "    protocol         = \"tcp\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mprotocol\u001b[0m         = \u001b[38;5;37m\"tcp\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 132,
                  "Content": "    cidr_blocks      = var.ingress_cidr_blocks",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mcidr_blocks\u001b[0m      = \u001b[38;5;33mvar\u001b[0m.ingress_cidr_blocks",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 133,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "module.bastion",
                "Filename": "bastion.tf",
                "Location": {
                  "StartLine": 3,
                  "EndLine": 18
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "aws-vpc-no-public-egress-sgr",
          "AVDID": "AVD-AWS-0104",
          "Title": "A security group rule should not allow unrestricted egress to any IP address.",
          "Description": "Opening up ports to connect out to the public internet is generally to be avoided. You should restrict access to IP addresses or ranges that are explicitly required where possible.\n",
          "Message": "Security group rule allows unrestricted egress to any IP address.",
          "Namespace": "builtin.aws.ec2.aws0104",
          "Query": "data.builtin.aws.ec2.aws0104.deny",
          "Resolution": "Set a more restrictive cidr range",
          "Severity": "CRITICAL",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/aws-vpc-no-public-egress-sgr",
          "References": [
            "https://docs.aws.amazon.com/whitepapers/latest/building-scalable-secure-multi-vpc-network-infrastructure/centralized-egress-to-internet.html",
            "https://avd.aquasec.com/misconfig/aws-vpc-no-public-egress-sgr"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "module.bastion",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 140,
            "EndLine": 140,
            "Code": {
              "Lines": [
                {
                  "Number": 124,
                  "Content": "resource \"aws_security_group\" \"bastion\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_security_group\"\u001b[0m \u001b[38;5;37m\"bastion\"\u001b[0m {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 125,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 140,
                  "Content": "    cidr_blocks      = var.egress_cidr_blocks",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mcidr_blocks\u001b[0m      = \u001b[38;5;33mvar\u001b[0m.egress_cidr_blocks",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 155,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 156,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "egress",
                "Filename": "umotif-public/bastion/aws/.terraform/modules/bastion/main.tf",
                "Location": {
                  "StartLine": 136,
                  "EndLine": 142
                }
              },
              {
                "Resource": "aws_security_group.bastion",
                "Filename": "umotif-public/bastion/aws/.terraform/modules/bastion/main.tf",
                "Location": {
                  "StartLine": 124,
                  "EndLine": 156
                }
              },
              {
                "Resource": "module.bastion",
                "Filename": "bastion.tf",
                "Location": {
                  "StartLine": 3,
                  "EndLine": 18
                }
              }
            ],
            "RenderedCause": {
              "Raw": "resource \"aws_security_group\" \"bastion\" {\n  egress {\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n}",
              "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_security_group\"\u001b[0m \u001b[38;5;37m\"bastion\"\u001b[0m {\n  egress {\n    \u001b[38;5;245mcidr_blocks\u001b[0m = [\u001b[38;5;37m\"0.0.0.0/0\"\u001b[0m]\n  }\n}"
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "aws-vpc-no-public-egress-sgr",
          "AVDID": "AVD-AWS-0104",
          "Title": "A security group rule should not allow unrestricted egress to any IP address.",
          "Description": "Opening up ports to connect out to the public internet is generally to be avoided. You should restrict access to IP addresses or ranges that are explicitly required where possible.\n",
          "Message": "Security group rule allows unrestricted egress to any IP address.",
          "Namespace": "builtin.aws.ec2.aws0104",
          "Query": "data.builtin.aws.ec2.aws0104.deny",
          "Resolution": "Set a more restrictive cidr range",
          "Severity": "CRITICAL",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/aws-vpc-no-public-egress-sgr",
          "References": [
            "https://docs.aws.amazon.com/whitepapers/latest/building-scalable-secure-multi-vpc-network-infrastructure/centralized-egress-to-internet.html",
            "https://avd.aquasec.com/misconfig/aws-vpc-no-public-egress-sgr"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "module.bastion",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 141,
            "EndLine": 141,
            "Code": {
              "Lines": [
                {
                  "Number": 124,
                  "Content": "resource \"aws_security_group\" \"bastion\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_security_group\"\u001b[0m \u001b[38;5;37m\"bastion\"\u001b[0m {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 125,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 141,
                  "Content": "    ipv6_cidr_blocks = var.egress_ipv6_cidr_blocks",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mipv6_cidr_blocks\u001b[0m = \u001b[38;5;33mvar\u001b[0m.egress_ipv6_cidr_blocks",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 155,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 156,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "egress",
                "Filename": "umotif-public/bastion/aws/.terraform/modules/bastion/main.tf",
                "Location": {
                  "StartLine": 136,
                  "EndLine": 142
                }
              },
              {
                "Resource": "aws_security_group.bastion",
                "Filename": "umotif-public/bastion/aws/.terraform/modules/bastion/main.tf",
                "Location": {
                  "StartLine": 124,
                  "EndLine": 156
                }
              },
              {
                "Resource": "module.bastion",
                "Filename": "bastion.tf",
                "Location": {
                  "StartLine": 3,
                  "EndLine": 18
                }
              }
            ],
            "RenderedCause": {
              "Raw": "resource \"aws_security_group\" \"bastion\" {\n  egress {\n    ipv6_cidr_blocks = [\"::/0\"]\n  }\n}",
              "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_security_group\"\u001b[0m \u001b[38;5;37m\"bastion\"\u001b[0m {\n  egress {\n    \u001b[38;5;245mipv6_cidr_blocks\u001b[0m = [\u001b[38;5;37m\"::/0\"\u001b[0m]\n  }\n}"
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0107",
          "AVDID": "AVD-AWS-0107",
          "Title": "Security groups should not allow unrestricted ingress to SSH or RDP from any IP address.",
          "Description": "Security groups provide stateful filtering of ingress and egress network traffic to AWS\nresources. It is recommended that no security group allows unrestricted ingress access to\nremote server administration ports, such as SSH to port 22 and RDP to port 3389.\n",
          "Message": "Security group rule allows unrestricted ingress from any IP address.",
          "Namespace": "builtin.aws.ec2.aws0107",
          "Query": "data.builtin.aws.ec2.aws0107.deny",
          "Resolution": "Set a more restrictive CIDR range",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0107",
          "References": [
            "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/security-group-rules-reference.html",
            "https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html#ec2-13",
            "https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html#ec2-14",
            "https://avd.aquasec.com/misconfig/avd-aws-0107"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "module.bastion",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 132,
            "EndLine": 132,
            "Code": {
              "Lines": [
                {
                  "Number": 124,
                  "Content": "resource \"aws_security_group\" \"bastion\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_security_group\"\u001b[0m \u001b[38;5;37m\"bastion\"\u001b[0m {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 125,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 132,
                  "Content": "    cidr_blocks      = var.ingress_cidr_blocks",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mcidr_blocks\u001b[0m      = \u001b[38;5;33mvar\u001b[0m.ingress_cidr_blocks",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 155,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 156,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "ingress",
                "Filename": "umotif-public/bastion/aws/.terraform/modules/bastion/main.tf",
                "Location": {
                  "StartLine": 128,
                  "EndLine": 134
                }
              },
              {
                "Resource": "aws_security_group.bastion",
                "Filename": "umotif-public/bastion/aws/.terraform/modules/bastion/main.tf",
                "Location": {
                  "StartLine": 124,
                  "EndLine": 156
                }
              },
              {
                "Resource": "module.bastion",
                "Filename": "bastion.tf",
                "Location": {
                  "StartLine": 3,
                  "EndLine": 18
                }
              }
            ],
            "RenderedCause": {
              "Raw": "resource \"aws_security_group\" \"bastion\" {\n  ingress {\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n}",
              "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_security_group\"\u001b[0m \u001b[38;5;37m\"bastion\"\u001b[0m {\n  ingress {\n    \u001b[38;5;245mcidr_blocks\u001b[0m = [\u001b[38;5;37m\"0.0.0.0/0\"\u001b[0m]\n  }\n}"
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0107",
          "AVDID": "AVD-AWS-0107",
          "Title": "Security groups should not allow unrestricted ingress to SSH or RDP from any IP address.",
          "Description": "Security groups provide stateful filtering of ingress and egress network traffic to AWS\nresources. It is recommended that no security group allows unrestricted ingress access to\nremote server administration ports, such as SSH to port 22 and RDP to port 3389.\n",
          "Message": "Security group rule allows unrestricted ingress from any IP address.",
          "Namespace": "builtin.aws.ec2.aws0107",
          "Query": "data.builtin.aws.ec2.aws0107.deny",
          "Resolution": "Set a more restrictive CIDR range",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0107",
          "References": [
            "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/security-group-rules-reference.html",
            "https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html#ec2-13",
            "https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html#ec2-14",
            "https://avd.aquasec.com/misconfig/avd-aws-0107"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "module.bastion",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 133,
            "EndLine": 133,
            "Code": {
              "Lines": [
                {
                  "Number": 124,
                  "Content": "resource \"aws_security_group\" \"bastion\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_security_group\"\u001b[0m \u001b[38;5;37m\"bastion\"\u001b[0m {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 125,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 133,
                  "Content": "    ipv6_cidr_blocks = var.ingress_ipv6_cidr_blocks",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mipv6_cidr_blocks\u001b[0m = \u001b[38;5;33mvar\u001b[0m.ingress_ipv6_cidr_blocks",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 155,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 156,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "ingress",
                "Filename": "umotif-public/bastion/aws/.terraform/modules/bastion/main.tf",
                "Location": {
                  "StartLine": 128,
                  "EndLine": 134
                }
              },
              {
                "Resource": "aws_security_group.bastion",
                "Filename": "umotif-public/bastion/aws/.terraform/modules/bastion/main.tf",
                "Location": {
                  "StartLine": 124,
                  "EndLine": 156
                }
              },
              {
                "Resource": "module.bastion",
                "Filename": "bastion.tf",
                "Location": {
                  "StartLine": 3,
                  "EndLine": 18
                }
              }
            ],
            "RenderedCause": {
              "Raw": "resource \"aws_security_group\" \"bastion\" {\n  ingress {\n    ipv6_cidr_blocks = [\"::/0\"]\n  }\n}",
              "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_security_group\"\u001b[0m \u001b[38;5;37m\"bastion\"\u001b[0m {\n  ingress {\n    \u001b[38;5;245mipv6_cidr_blocks\u001b[0m = [\u001b[38;5;37m\"::/0\"\u001b[0m]\n  }\n}"
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "aws-vpc-add-description-to-security-group-rule",
          "AVDID": "AVD-AWS-0124",
          "Title": "Missing description for security group rule.",
          "Description": "Security group rules should include a description for auditing purposes.\n\nSimplifies auditing, debugging, and managing security groups.\n",
          "Message": "Security group rule does not have a description.",
          "Namespace": "builtin.aws.ec2.aws0124",
          "Query": "data.builtin.aws.ec2.aws0124.deny",
          "Resolution": "Add descriptions for all security groups rules",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/aws-vpc-add-description-to-security-group-rule",
          "References": [
            "https://www.cloudconformity.com/knowledge-base/aws/EC2/security-group-rules-description.html",
            "https://avd.aquasec.com/misconfig/aws-vpc-add-description-to-security-group-rule"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "module.bastion",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 128,
            "EndLine": 134,
            "Code": {
              "Lines": [
                {
                  "Number": 124,
                  "Content": "resource \"aws_security_group\" \"bastion\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_security_group\"\u001b[0m \u001b[38;5;37m\"bastion\"\u001b[0m {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 125,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 128,
                  "Content": "  ingress {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  ingress {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 129,
                  "Content": "    from_port        = var.ssh_port",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mfrom_port\u001b[0m        = \u001b[38;5;33mvar\u001b[0m.ssh_port",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 130,
                  "Content": "    to_port          = var.ssh_port",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mto_port\u001b[0m          = \u001b[38;5;33mvar\u001b[0m.ssh_port",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 131,
                  "Content": "    protocol         = \"tcp\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mprotocol\u001b[0m         = \u001b[38;5;37m\"tcp\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 132,
                  "Content": "    cidr_blocks      = var.ingress_cidr_blocks",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mcidr_blocks\u001b[0m      = \u001b[38;5;33mvar\u001b[0m.ingress_cidr_blocks",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 133,
                  "Content": "    ipv6_cidr_blocks = var.ingress_ipv6_cidr_blocks",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mipv6_cidr_blocks\u001b[0m = \u001b[38;5;33mvar\u001b[0m.ingress_ipv6_cidr_blocks",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 134,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  }",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 155,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "aws_security_group.bastion",
                "Filename": "umotif-public/bastion/aws/.terraform/modules/bastion/main.tf",
                "Location": {
                  "StartLine": 124,
                  "EndLine": 156
                }
              },
              {
                "Resource": "module.bastion",
                "Filename": "bastion.tf",
                "Location": {
                  "StartLine": 3,
                  "EndLine": 18
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "aws-vpc-add-description-to-security-group-rule",
          "AVDID": "AVD-AWS-0124",
          "Title": "Missing description for security group rule.",
          "Description": "Security group rules should include a description for auditing purposes.\n\nSimplifies auditing, debugging, and managing security groups.\n",
          "Message": "Security group rule does not have a description.",
          "Namespace": "builtin.aws.ec2.aws0124",
          "Query": "data.builtin.aws.ec2.aws0124.deny",
          "Resolution": "Add descriptions for all security groups rules",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/aws-vpc-add-description-to-security-group-rule",
          "References": [
            "https://www.cloudconformity.com/knowledge-base/aws/EC2/security-group-rules-description.html",
            "https://avd.aquasec.com/misconfig/aws-vpc-add-description-to-security-group-rule"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "module.bastion",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 136,
            "EndLine": 142,
            "Code": {
              "Lines": [
                {
                  "Number": 124,
                  "Content": "resource \"aws_security_group\" \"bastion\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_security_group\"\u001b[0m \u001b[38;5;37m\"bastion\"\u001b[0m {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 125,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 136,
                  "Content": "  egress {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  egress {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 137,
                  "Content": "    from_port        = 0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mfrom_port\u001b[0m        = \u001b[38;5;37m0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 138,
                  "Content": "    to_port          = 0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mto_port\u001b[0m          = \u001b[38;5;37m0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 139,
                  "Content": "    protocol         = \"-1\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mprotocol\u001b[0m         = \u001b[38;5;37m\"-1\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 140,
                  "Content": "    cidr_blocks      = var.egress_cidr_blocks",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mcidr_blocks\u001b[0m      = \u001b[38;5;33mvar\u001b[0m.egress_cidr_blocks",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 141,
                  "Content": "    ipv6_cidr_blocks = var.egress_ipv6_cidr_blocks",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mipv6_cidr_blocks\u001b[0m = \u001b[38;5;33mvar\u001b[0m.egress_ipv6_cidr_blocks",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 142,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  }",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 155,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "aws_security_group.bastion",
                "Filename": "umotif-public/bastion/aws/.terraform/modules/bastion/main.tf",
                "Location": {
                  "StartLine": 124,
                  "EndLine": 156
                }
              },
              {
                "Resource": "module.bastion",
                "Filename": "bastion.tf",
                "Location": {
                  "StartLine": 3,
                  "EndLine": 18
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "aws-autoscaling-enforce-http-token-imds",
          "AVDID": "AVD-AWS-0130",
          "Title": "aws_instance should activate session tokens for Instance Metadata Service.",
          "Description": "IMDS v2 (Instance Metadata Service) introduced session authentication tokens which improve security when talking to IMDS.\n\nBy default \u003ccode\u003eaws_instance\u003c/code\u003e resource sets IMDS session auth tokens to be optional.\n\nTo fully protect IMDS you need to enable session tokens by using \u003ccode\u003emetadata_options\u003c/code\u003e block and its \u003ccode\u003ehttp_tokens\u003c/code\u003e variable set to \u003ccode\u003erequired\u003c/code\u003e.\n",
          "Message": "Launch template does not require IMDS access to require a token",
          "Namespace": "builtin.aws.ec2.aws0130",
          "Query": "data.builtin.aws.ec2.aws0130.deny",
          "Resolution": "Enable HTTP token requirement for IMDS",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/aws-autoscaling-enforce-http-token-imds",
          "References": [
            "https://aws.amazon.com/blogs/security/defense-in-depth-open-firewalls-reverse-proxies-ssrf-vulnerabilities-ec2-instance-metadata-service",
            "https://avd.aquasec.com/misconfig/aws-autoscaling-enforce-http-token-imds"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "module.bastion",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 5,
            "EndLine": 38,
            "Code": {
              "Lines": [
                {
                  "Number": 5,
                  "Content": "resource \"aws_launch_template\" \"bastion\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_launch_template\"\u001b[0m \u001b[38;5;37m\"bastion\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 6,
                  "Content": "  name_prefix = \"${var.name_prefix}-bastion-\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mname_prefix\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.name_prefix\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-bastion-\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 7,
                  "Content": "  image_id    = var.ami_id != \"\" ? var.ami_id : data.aws_ami.amazon_linux.id",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mimage_id\u001b[0m    = \u001b[38;5;33mvar\u001b[0m.ami_id \u001b[38;5;245m!=\u001b[0m \u001b[38;5;37m\"\"\u001b[0m \u001b[38;5;245m?\u001b[0m \u001b[38;5;33mvar\u001b[0m.ami_id \u001b[38;5;245m:\u001b[0m \u001b[38;5;33mdata\u001b[0m.aws_ami.amazon_linux.id",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 8,
                  "Content": "  key_name    = var.ssh_key_name",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mkey_name\u001b[0m    = \u001b[38;5;33mvar\u001b[0m.ssh_key_name",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 9,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 10,
                  "Content": "  iam_instance_profile {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  iam_instance_profile {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 11,
                  "Content": "    name = aws_iam_instance_profile.bastion.name",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mname\u001b[0m = aws_iam_instance_profile.bastion.name",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 12,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  }",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 13,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 14,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "module.bastion",
                "Filename": "bastion.tf",
                "Location": {
                  "StartLine": 3,
                  "EndLine": 18
                }
              }
            ],
            "RenderedCause": {}
          }
        }
      ]
    }
  ]
}
